---
- hosts: appserver
  become: true
  tasks:
  - name: install apache2
    apt:
      name: apache2
      update_cache: yes
      state: latest

  - name: enabled mod_rewrite
    apache2_module:
      name: rewrite
      state: present
    notify:
      - restart apache2
  - name: backup default page
    command: mv /var/www/html/index.html /var/www/html/backup_default_index.html

  - name: copy html file to remote host
    copy:
      src: /home/waynelin/272HW1/index.html
      dest: /var/www/html/
      owner: ubuntu
      group: ubuntu
      mode: preserve
      

  handlers:
  - name: restart apache2
    service:
      name: apache2
      state: restarted
